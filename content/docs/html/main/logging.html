<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="Apache Pekko is a toolkit for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala.">
<meta name="generator" content="Paradox, paradox-material-theme=0.6.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="Apache Pekko is a toolkit for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala.">
<link rel="shortcut icon" href="assets/images/favicon.png">
<title>Classic Logging Â· Apache Pekko</title>
<link rel="stylesheet" href="assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="lib/prettify/prettify.css">
<script src="assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="assets/fonts/font-awesome.css">
<link rel="stylesheet" href="assets/fonts/material-icons.css">
<link rel="stylesheet" href="assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="index.html" title="Apache Pekko" class="md-header-nav__button md-logo">
<img src="images/pekko_logo.png" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Apache Pekko
</span>
<span class="md-header-nav__topic">
Classic Logging
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/apache/incubator-pekko"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
apache/incubator-pekko
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="index.html" title="Apache Pekko" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<img src="images/pekko_logo.png" width="24" height="24">
</a>
<a href="index.html" title="Apache Pekko">
Apache Pekko
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/apache/incubator-pekko"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
apache/incubator-pekko
</div>
</a>

</div>
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
<ul>
  <li><a href="security/index.html" class="page">Security Announcements</a></li>
  <li><a href="downloads.html" class="page">Downloads</a></li>
  <li><a href="documentation.html" class="page">Documentation</a>
  <ul>
    <li><a href="typed/guide/index.html" class="page">Getting Started Guide</a></li>
    <li><a href="general/index.html" class="page">General Concepts</a></li>
    <li><a href="typed/index.html" class="page">Actors</a></li>
    <li><a href="typed/index-cluster.html" class="page">Cluster</a></li>
    <li><a href="typed/index-persistence.html" class="page">Persistence (Event Sourcing)</a></li>
    <li><a href="typed/index-persistence-durable-state.html" class="page">Persistence (Durable State)</a></li>
    <li><a href="stream/index.html" class="page">Streams</a></li>
    <li><a href="discovery/index.html" class="page">Discovery</a></li>
    <li><a href="index-utilities.html" class="page">Utilities</a></li>
    <li><a href="common/other-modules.html" class="page">Other Apache Pekko modules</a></li>
    <li><a href="additional/deploy.html" class="page">Package, Deploy and Run</a></li>
    <li><a href="project/index.html" class="page">Project Information</a></li>
    <li><a href="index-classic.html" class="page">Pekko Classic</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="logging.html#classic-logging" class="header">Classic Logging</a>
  <ul>
    <li><a href="logging.html#module-info" class="header">Module info</a></li>
    <li><a href="logging.html#introduction" class="header">Introduction</a></li>
    <li><a href="logging.html#how-to-log" class="header">How to Log</a></li>
    <li><a href="logging.html#loggers" class="header">Loggers</a></li>
    <li><a href="logging.html#logging-to-stdout-during-startup-and-shutdown" class="header">Logging to stdout during startup and shutdown</a></li>
    <li><a href="logging.html#slf4j" class="header">SLF4J</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 2.6.20+81-523134c3+20230202-1514*
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="logging.html#classic-logging" class="header">Classic Logging</a>
  <ul>
    <li><a href="logging.html#module-info" class="header">Module info</a></li>
    <li><a href="logging.html#introduction" class="header">Introduction</a></li>
    <li><a href="logging.html#how-to-log" class="header">How to Log</a></li>
    <li><a href="logging.html#loggers" class="header">Loggers</a></li>
    <li><a href="logging.html#logging-to-stdout-during-startup-and-shutdown" class="header">Logging to stdout during startup and shutdown</a></li>
    <li><a href="logging.html#slf4j" class="header">SLF4J</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#classic-logging" name="classic-logging" class="anchor"><span class="anchor-link"></span></a>Classic Logging</h1><div class="callout note "><div class="callout-title">Note</div>
<p>Pekko Classic pertains to the original Actor APIs, which have been improved by more type safe and guided Actor APIs. Pekko Classic is still fully supported and existing applications can continue to use the classic APIs. It is also possible to use the new Actor APIs together with classic actors in the same ActorSystem, see <a href="typed/coexisting.html">coexistence</a>. For new projects we recommend using <a href="typed/actors.html">the new Actor API</a>.</p></div>
<p>For the new API see <a href="typed/logging.html">Logging</a>.</p>
<h2><a href="#module-info" name="module-info" class="anchor"><span class="anchor-link"></span></a>Module info</h2>
<p>To use Logging, you must at least use the Pekko actors dependency in your project, and will most likely want to configure logging via the SLF4J module (<a href="logging.html#slf4j">see below</a>).</p><dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">val PekkoVersion = "2.6.20+81-523134c3+20230202-1514-SNAPSHOT"
libraryDependencies += "org.apache.pekko" %% "pekko-actor" % PekkoVersion</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;scala.binary.version&gt;2.13&lt;/scala.binary.version&gt;
&lt;/properties&gt;
&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.pekko&lt;/groupId&gt;
      &lt;artifactId&gt;pekko-bom_${scala.binary.version}&lt;/artifactId&gt;
      &lt;version&gt;2.6.20+81-523134c3+20230202-1514-SNAPSHOT&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
&lt;dependencies&gt
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.pekko&lt;/groupId&gt;
    &lt;artifactId&gt;pekko-actor_${scala.binary.version}&lt;/artifactId&gt;
  &lt;/dependency&gt
&lt;/dependencies&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">def versions = [
  ScalaBinary: "2.13"
]
dependencies {
  implementation platform("org.apache.pekko:pekko-bom_${versions.ScalaBinary}:2.6.20+81-523134c3+20230202-1514-SNAPSHOT")

  implementation "org.apache.pekko:pekko-actor_${versions.ScalaBinary}"
}</code></pre></dd></dl>
<table class="project-info">
<tr><th colspan="2">Project Info: Pekko Logging (classic)</th></tr>
  <tr><th>Artifact</th><td><div>org.apache.pekko</div>
  <div>pekko-slf4j</div>
  <div>2.6.20+81-523134c3+20230202-1514-SNAPSHOT</div>
  <div><a href="project/links.html#snapshots-repository">Snapshots are available</a></div>
  </td></tr>
  <tr><th>JDK versions</th><td><div>Adopt OpenJDK 8</div><div>Adopt OpenJDK 11</div></td></tr>
  <tr><th>Scala versions</th><td>2.13.8, 2.12.16, 3.1.2</td></tr>
  <tr><th>JPMS module name</th><td>pekko.slf4j</td></tr>
  <tr><th>License</th><td><div><a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache-2.0</a></div>
  </td></tr>
  
  <tr><th>Home page</th><td><a href="https://pekko.apache.org/">https://pekko.apache.org/</a></td></tr>
  <tr><th>API documentation</th><td>
  <div><a href="https://pekko.apache.org/api/pekko/snapshot/pekko/event/slf4j/index.html" target="_blank" rel="noopener noreferrer">API (Scaladoc)</a></div>
  <div><a href="https://pekko.apache.org/japi/pekko/snapshot/pekko/event/slf4j/package-summary.html" target="_blank" rel="noopener noreferrer">API (Javadoc)</a></div>
  </td></tr>
  <tr><th>Forums</th><td>
  <div><a href="https://lists.apache.org/list.html?dev@pekko.apache.org" target="_blank" rel="noopener noreferrer">Apache Pekko Dev mailing list</a></div>
  <div><a href="https://github.com/apache/incubator-pekko/discussions" target="_blank" rel="noopener noreferrer">apache/incubator-pekko discussion</a></div>
  </td></tr>
  <tr><th>Release notes</th><td><a href="https://akka.io/blog/news-archive.html">akka.io blog</a></td></tr>
  <tr><th>Issues</th><td><a href="https://github.com/apache/incubator-pekko/issues" target="_blank" rel="noopener noreferrer">Github issues</a></td></tr>
  <tr><th>Sources</th><td><a href="https://github.com/apache/incubator-pekko" target="_blank" rel="noopener noreferrer">https://github.com/apache/incubator-pekko</a></td></tr>
</table>

<h2><a href="#introduction" name="introduction" class="anchor"><span class="anchor-link"></span></a>Introduction</h2>

<p>Logging in Pekko is not tied to a specific logging backend. By default log messages are printed to STDOUT, but you can plug-in a SLF4J logger or your own logger. Logging is performed asynchronously to ensure that logging has minimal performance impact. Logging generally means IO and locks, which can slow down the operations of your code if it was performed synchronously.</p>

<h2><a href="#how-to-log" name="how-to-log" class="anchor"><span class="anchor-link"></span></a>How to Log</h2>

<p>Create a <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span> and use the <code>error</code>, <code>warning</code>, <code>info</code>, or <code>debug</code> methods, as illustrated in this example:</p>

<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/scala/docs/event/LoggingDocSpec.scala#L23-L37" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import org.apache.pekko.event.Logging

class MyActor extends Actor {
  val log = Logging(context.system, this)
  override def preStart() = {
    log.debug(&quot;Starting&quot;)
  }
  override def preRestart(reason: Throwable, message: Option[Any]): Unit = {
    log.error(reason, &quot;Restarting due to [{}] when processing [{}]&quot;, reason.getMessage, message.getOrElse(&quot;&quot;))
  }
  def receive = {
    case &quot;test&quot; =&gt; log.info(&quot;Received test&quot;)
    case x      =&gt; log.warning(&quot;Received unknown message: {}&quot;, x)
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L17-L20" target="_blank" title="Go to snippet source">source</a><code class="language-java">import org.apache.pekko.actor.*;
import org.apache.pekko.event.Logging;
import org.apache.pekko.event.LoggingAdapter;
</code></pre>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L167-L192" target="_blank" title="Go to snippet source">source</a><code class="language-java">class MyActor extends AbstractActor {
  LoggingAdapter log = Logging.getLogger(getContext().getSystem(), this);

  @Override
  public void preStart() {
    log.debug(&quot;Starting&quot;);
  }

  @Override
  public void preRestart(Throwable reason, Optional&lt;Object&gt; message) {
    log.error(
        reason,
        &quot;Restarting due to [{}] when processing [{}]&quot;,
        reason.getMessage(),
        message.isPresent() ? message.get() : &quot;&quot;);
  }

  @Override
  public Receive createReceive() {
    return receiveBuilder()
        .matchEquals(&quot;test&quot;, msg -&gt; log.info(&quot;Received test&quot;))
        .matchAny(msg -&gt; log.warning(&quot;Received unknown message: {}&quot;, msg))
        .build();
  }
}
</code></pre></dd>
</dl><div class="group-scala">
<p>For convenience, you can mix in the <code>log</code> member into actors, instead of defining it as above.</p>
<pre class="prettyprint"><code class="language-scala">class MyActor extends Actor with org.apache.pekko.actor.ActorLogging {
  ...
}
</code></pre></div>
<p>The first parameter to <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/Logging$.html#apply[T](bus:org.apache.pekko.event.LoggingBus,logSource:T)(implicitevidence$5:org.apache.pekko.event.LogSource[T]):org.apache.pekko.event.LoggingAdapter" title="pekko.event.Logging"><code>Logging</code></a></span> <span class="group-java"><a href="https://pekko.apache.org/japi/pekko/current/org/apache/pekko/event/Logging.html#getLogger(org.apache.pekko.event.LoggingBus,java.lang.Object)" title="pekko.event.Logging"><code>Logging.getLogger</code></a></span> could also be any <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingBus.html" title="org.apache.pekko.event.LoggingBus"><code>LoggingBus</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingBus.html" title="org.apache.pekko.event.LoggingBus"><code>LoggingBus</code></a></span>, specifically <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/actor/ActorSystem.html#eventStream:org.apache.pekko.event.EventStream" title="pekko.actor.ActorSystem"><code>system.eventStream</code></a></span> <span class="group-java"><a href="https://pekko.apache.org/japi/pekko/current/org/apache/pekko/actor/ActorSystem.html#getEventStream()" title="pekko.actor.ActorSystem"><code>system.getEventStream()</code></a></span>. In the demonstrated case, the actor system&rsquo;s address is included in the <code>pekkoSource</code> representation of the log source (see <a href="logging.html#logging-thread-pekko-source-and-actor-system-in-mdc">Logging Thread, Pekko Source and Actor System in MDC</a>), while in the second case this is not automatically done. The second parameter to <span class="group-scala"><code>Logging</code></span> <span class="group-java"><code>Logging.getLogger</code></span> is the source of this logging channel. The source object is translated to a String according to the following rules:</p>
<ul>
  <li>if it is an Actor or ActorRef, its path is used</li>
  <li>in case of a String it is used as is</li>
  <li>in case of a Class an approximation of its <code>simpleName</code> is used</li>
  <li>in all other cases <span class="group-scala">a compile error occurs unless an implicit <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/LogSource.html" title="pekko.event.LogSource"><code>LogSource[T]</code></a> is in scope for the type in question</span> <span class="group-java">the <code>simpleName</code> of its class</span> is used</li>
</ul>
<p>The log message may contain argument placeholders <code>{}</code>, which will be substituted if the log level is enabled. Compared to constructing a full string for the log message this has the advantage of avoiding superfluous string concatenation and object allocations when the log level is disabled. Giving more arguments than placeholders results in a warning being appended to the log statement (i.e. on the same line with the same severity). You may pass an array as the only substitution argument to have its elements be treated individually:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/scala/docs/event/LoggingDocSpec.scala#L218-L219" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val args = Array(&quot;The&quot;, &quot;brown&quot;, &quot;fox&quot;, &quot;jumps&quot;, 42)
system.log.debug(&quot;five parameters: {}, {}, {}, {}, {}&quot;, args)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L160-L161" target="_blank" title="Go to snippet source">source</a><code class="language-java">final Object[] args = new Object[] {&quot;The&quot;, &quot;brown&quot;, &quot;fox&quot;, &quot;jumps&quot;, 42};
system.log().debug(&quot;five parameters: {}, {}, {}, {}, {}&quot;, args);</code></pre></dd>
</dl>
<p>The Java <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html" title="java.lang.Class"><code>Class</code></a> of the log source is also included in the generated <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/Logging$$LogEvent.html" title="org.apache.pekko.event.Logging.LogEvent"><code>Logging.LogEvent</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/Logging$$LogEvent.html" title="org.apache.pekko.event.Logging.LogEvent"><code>Logging.LogEvent</code></a></span>. In case of a simple string this is replaced with a âmarkerâ class <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/DummyClassForStringSources.html" title="org.apache.pekko.event.DummyClassForStringSources"><code>DummyClassForStringSources</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/DummyClassForStringSources.html" title="org.apache.pekko.event.DummyClassForStringSources"><code>DummyClassForStringSources</code></a></span> in order to allow special treatment of this case, e.g. in the SLF4J event listener which will then use the string instead of the classâ name for looking up the logger instance to use.</p>
<h3><a href="#logging-of-dead-letters" name="logging-of-dead-letters" class="anchor"><span class="anchor-link"></span></a>Logging of Dead Letters</h3>
<p>By default messages sent to dead letters are logged at <code>INFO</code> level. Existence of dead letters does not necessarily indicate a problem, but they are logged by default for the sake of caution. After a few messages this logging is turned off, to avoid flooding the logs. You can disable this logging completely or adjust how many dead letters are logged. During system shutdown it is likely that you see dead letters, since pending messages in the actor mailboxes are sent to dead letters. You can also disable logging of dead letters during shutdown.</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  log-dead-letters = 10
  log-dead-letters-during-shutdown = on
}
</code></pre>
<p>To customize the logging further or take other actions for dead letters you can subscribe to the <a href="event-bus.html#event-stream">Event Stream</a>.</p>
<h3><a href="#auxiliary-logging-options" name="auxiliary-logging-options" class="anchor"><span class="anchor-link"></span></a>Auxiliary logging options</h3>
<p>Pekko has a few configuration options for very low level debugging. These make more sense in development than in production.</p>
<p>You almost definitely need to have logging set to <code>DEBUG</code> to use any of the options below:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  loglevel = &quot;DEBUG&quot;
}
</code></pre>
<p>This config option is very good if you want to know what config settings are loaded by Pekko:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  # Log the complete configuration at INFO level when the actor system is started.
  # This is useful when you are uncertain of what configuration is used.
  log-config-on-start = on
}
</code></pre><div class="group-scala">
<p>If you want very detailed logging of user-level messages then wrap your actors&rsquo; behaviors with <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/LoggingReceive.html" title="pekko.event.LoggingReceive"><code>LoggingReceive</code></a> and enable the <code>receive</code> option:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  actor {
    debug {
      # enable function of LoggingReceive, which is to log any received message at
      # DEBUG level
      receive = on
    }
  }
}
</code></pre></div>
<p>If you want very detailed logging of all automatically received messages that are processed by Actors:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  actor {
    debug {
      # enable DEBUG logging of all AutoReceiveMessages (Kill, PoisonPill etc.)
      autoreceive = on
    }
  }
}
</code></pre>
<p>If you want very detailed logging of all lifecycle changes of Actors (restarts, deaths etc.):</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  actor {
    debug {
      # enable DEBUG logging of actor lifecycle changes
      lifecycle = on
    }
  }
}
</code></pre>
<p>If you want unhandled messages logged at <code>DEBUG</code>:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  actor {
    debug {
      # enable DEBUG logging of unhandled messages
      unhandled = on
    }
  }
}
</code></pre>
<p>If you want very detailed logging of all events, transitions and timers of FSM Actors that extend LoggingFSM:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  actor {
    debug {
      # enable DEBUG logging of all LoggingFSMs for events, transitions and timers
      fsm = on
    }
  }
}
</code></pre>
<p>If you want to monitor subscriptions (subscribe/unsubscribe) on the ActorSystem.eventStream:</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  actor {
    debug {
      # enable DEBUG logging of subscription changes on the eventStream
      event-stream = on
    }
  }
}
</code></pre>
<a id="logging-remote"></a>
<h3><a href="#auxiliary-remote-logging-options" name="auxiliary-remote-logging-options" class="anchor"><span class="anchor-link"></span></a>Auxiliary remote logging options</h3>
<p>If you want to see all messages that are sent through remoting at <code>DEBUG</code> log level, use the following config option. Note that this logs the messages as they are sent by the transport layer, not by an actor.</p>
<pre class="prettyprint"><code class="language-ruby">pekko.remote.artery {
  # If this is &quot;on&quot;, Pekko will log all outbound messages at DEBUG level,
  # if off then they are not logged
  log-sent-messages = on
}
</code></pre>
<p>If you want to see all messages that are received through remoting at <code>DEBUG</code> log level, use the following config option. Note that this logs the messages as they are received by the transport layer, not by an actor.</p>
<pre class="prettyprint"><code class="language-ruby">pekko.remote.artery {
  # If this is &quot;on&quot;, Pekko will log all inbound messages at DEBUG level,
  # if off then they are not logged
  log-received-messages = on
}
</code></pre>
<p>Also see the <a href="testing.html#actor-logging">logging options for TestKit</a>.</p><div class="group-scala">
<h3><a href="#translating-log-source-to-string-and-class" name="translating-log-source-to-string-and-class" class="anchor"><span class="anchor-link"></span></a>Translating Log Source to String and Class</h3>
<p>The rules for translating the source object to the source string and class which are inserted into the <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/Logging$$LogEvent.html" title="pekko.event.Logging.LogEvent"><code>LogEvent</code></a> during runtime are implemented using implicit parameters and thus fully customizable: create your own instance of <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/LogSource.html" title="pekko.event.LogSource"><code>LogSource[T]</code></a> and have it in scope when creating the logger.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/scala/docs/event/LoggingDocSpec.scala#L108-L124" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import org.apache.pekko
import pekko.actor.ActorSystem
import pekko.event.LogSource

object MyType {
  implicit val logSource: LogSource[AnyRef] = new LogSource[AnyRef] {
    def genString(o: AnyRef): String = o.getClass.getName
    override def getClazz(o: AnyRef): Class[_] = o.getClass
  }
}

class MyType(system: ActorSystem) {
  import MyType._
  import pekko.event.Logging

  val log = Logging(system, this)
}</code></pre>
<p>This example creates a log source which mimics traditional usage of Java loggers, which are based upon the originating objectâs class name as log category. The override of <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/LogSource.html#getClazz(t:T):Class[_]" title="pekko.event.LogSource"><code>getClazz</code></a> is only included for demonstration purposes as it contains exactly the default behavior.</p></div><div class="callout note group-scala"><div class="callout-title">Note</div>
<p>You may also create the string representation up front and pass that in as the log source, but be aware that then the <code>Class[_]</code> which will be put in the <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/Logging$$LogEvent.html" title="pekko.event.Logging.LogEvent"><code>LogEvent</code></a> is <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/event/DummyClassForStringSources.html" title="pekko.event.DummyClassForStringSources"><code>event.DummyClassForStringSources</code></a>.</p>
<p>The SLF4J event listener treats this case specially (using the actual string to look up the logger instance to use instead of the classâ name), and you might want to do this also in case you implement your own logging adapter.</p></div>
<h3><a href="#turn-off-logging" name="turn-off-logging" class="anchor"><span class="anchor-link"></span></a>Turn Off Logging</h3>
<p>To turn off logging you can configure the log levels to be <code>OFF</code> like this.</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  stdout-loglevel = &quot;OFF&quot;
  loglevel = &quot;OFF&quot;
}
</code></pre>
<p>The <code>stdout-loglevel</code> is only in effect during system startup and shutdown, and setting it to <code>OFF</code> as well, ensures that nothing gets logged during system startup or shutdown.</p>
<h2><a href="#loggers" name="loggers" class="anchor"><span class="anchor-link"></span></a>Loggers</h2>
<p>Logging is performed asynchronously through an event bus. Log events are processed by an event handler actor that receives the log events in the same order they were emitted.</p><div class="callout note "><div class="callout-title">Note</div>
<p>The event handler actor does not have a bounded inbox and is run on the default dispatcher. This means that logging extreme amounts of data may affect your application badly. This can be somewhat mitigated by using an async logging backend though. (See <a href="logging.html#slf4j-directly">Using the SLF4J API directly</a>)</p></div>
<p>You can configure which event handlers are created at system start-up and listen to logging events. That is done using the <code>loggers</code> element in the <a href="general/configuration.html">configuration</a>. Here you can also define the log level. More fine grained filtering based on the log source can be implemented in a custom <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingFilter.html" title="org.apache.pekko.event.LoggingFilter"><code>LoggingFilter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingFilter.html" title="org.apache.pekko.event.LoggingFilter"><code>LoggingFilter</code></a></span>, which can be defined in the <code>logging-filter</code> configuration property.</p>
<pre class="prettyprint"><code class="language-ruby">pekko {
  # Loggers to register at boot time (org.apache.pekko.event.Logging$DefaultLogger logs
  # to STDOUT)
  loggers = [&quot;org.apache.pekko.event.Logging$DefaultLogger&quot;]
  # Options: OFF, ERROR, WARNING, INFO, DEBUG
  loglevel = &quot;DEBUG&quot;
}
</code></pre>
<p>The default one logs to STDOUT and is registered by default. It is not intended to be used for production. There is also an <a href="logging.html#slf4j">SLF4J</a> logger available in the &lsquo;pekko-slf4j&rsquo; module.</p><div class="callout note "><div class="callout-title">Note</div>
<p>If <code>pekko-actor-typed</code> is available on your classpath, logging will automatically switch to <a href="logging.html#slf4j">SLF4J</a> instead of the default logger. See the <a href="typed/logging.html#event-bus">Pekko typed logging</a> docs for more details.</p></div>
<p>Example of creating a listener:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/scala/docs/event/LoggingDocSpec.scala#L88-L104" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import org.apache.pekko
import pekko.event.Logging.Debug
import pekko.event.Logging.Error
import pekko.event.Logging.Info
import pekko.event.Logging.InitializeLogger
import pekko.event.Logging.LoggerInitialized
import pekko.event.Logging.Warning

class MyEventListener extends Actor {
  def receive = {
    case InitializeLogger(_)                        =&gt; sender() ! LoggerInitialized
    case Error(cause, logSource, logClass, message) =&gt; // ...
    case Warning(logSource, logClass, message)      =&gt; // ...
    case Info(logSource, logClass, message)         =&gt; // ...
    case Debug(logSource, logClass, message)        =&gt; // ...
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L17-L20" target="_blank" title="Go to snippet source">source</a><code class="language-java">import org.apache.pekko.actor.*;
import org.apache.pekko.event.Logging;
import org.apache.pekko.event.LoggingAdapter;

import org.apache.pekko.event.Logging.InitializeLogger;
import org.apache.pekko.event.Logging.Error;
import org.apache.pekko.event.Logging.Warning;
import org.apache.pekko.event.Logging.Info;
import org.apache.pekko.event.Logging.Debug;
</code></pre>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L222-L253" target="_blank" title="Go to snippet source">source</a><code class="language-java">class MyEventListener extends AbstractActor {
  @Override
  public Receive createReceive() {
    return receiveBuilder()
        .match(
            InitializeLogger.class,
            msg -&gt; {
              getSender().tell(Logging.loggerInitialized(), getSelf());
            })
        .match(
            Error.class,
            msg -&gt; {
              // ...
            })
        .match(
            Warning.class,
            msg -&gt; {
              // ...
            })
        .match(
            Info.class,
            msg -&gt; {
              // ...
            })
        .match(
            Debug.class,
            msg -&gt; {
              // ...
            })
        .build();
  }
}</code></pre></dd>
</dl>
<h2><a href="#logging-to-stdout-during-startup-and-shutdown" name="logging-to-stdout-during-startup-and-shutdown" class="anchor"><span class="anchor-link"></span></a>Logging to stdout during startup and shutdown</h2>
<p>When the actor system is starting up and shutting down the configured <code>loggers</code> are not used. Instead log messages are printed to stdout (System.out). The default log level for this stdout logger is <code>WARNING</code> and it can be silenced completely by setting <code>pekko.stdout-loglevel=OFF</code>.</p>
<h2><a href="#slf4j" name="slf4j" class="anchor"><span class="anchor-link"></span></a>SLF4J</h2>
<p>Pekko provides a logger for <a href="https://www.slf4j.org/">SLF4J</a>. This module is available in the &lsquo;pekko-slf4j.jar&rsquo;. It has a single dependency: the slf4j-api jar. In your runtime, you also need a SLF4J backend. We recommend <a href="https://logback.qos.ch/">Logback</a>:</p><dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">val PekkoVersion = "2.6.20+81-523134c3+20230202-1514-SNAPSHOT"
libraryDependencies ++= Seq(
  "org.apache.pekko" %% "pekko-slf4j" % PekkoVersion,
  "ch.qos.logback" % "logback-classic" % "1.2.11"
)</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;scala.binary.version&gt;2.13&lt;/scala.binary.version&gt;
&lt;/properties&gt;
&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.pekko&lt;/groupId&gt;
      &lt;artifactId&gt;pekko-bom_${scala.binary.version}&lt;/artifactId&gt;
      &lt;version&gt;2.6.20+81-523134c3+20230202-1514-SNAPSHOT&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
&lt;dependencies&gt
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.pekko&lt;/groupId&gt;
    &lt;artifactId&gt;pekko-slf4j_${scala.binary.version}&lt;/artifactId&gt;
  &lt;/dependency&gt
  &lt;dependency&gt;
    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
    &lt;version&gt;1.2.11&lt;/version&gt;
  &lt;/dependency&gt
&lt;/dependencies&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">def versions = [
  ScalaBinary: "2.13"
]
dependencies {
  implementation platform("org.apache.pekko:pekko-bom_${versions.ScalaBinary}:2.6.20+81-523134c3+20230202-1514-SNAPSHOT")

  implementation "org.apache.pekko:pekko-slf4j_${versions.ScalaBinary}"
  implementation "ch.qos.logback:logback-classic:1.2.11"
}</code></pre></dd></dl>
<p>You need to enable the Slf4jLogger in the <code>loggers</code> element in the <a href="general/configuration.html">configuration</a>. Here you can also define the log level of the event bus. More fine grained log levels can be defined in the configuration of the SLF4J backend (e.g. logback.xml). You should also define <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/slf4j/Slf4jLoggingFilter.html" title="org.apache.pekko.event.slf4j.Slf4jLoggingFilter"><code>Slf4jLoggingFilter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/slf4j/Slf4jLoggingFilter.html" title="org.apache.pekko.event.slf4j.Slf4jLoggingFilter"><code>Slf4jLoggingFilter</code></a></span> in the <code>logging-filter</code> configuration property. It will filter the log events using the backend configuration (e.g. logback.xml) before they are published to the event bus.</p><div class="callout warning "><div class="callout-title">Warning</div>
<p>If you set the <code>loglevel</code> to a higher level than <code>DEBUG</code>, any <code>DEBUG</code> events will be filtered out already at the source and will never reach the logging backend, regardless of how the backend is configured.</p>
<p>You can enable <code>DEBUG</code> level for <code>pekko.loglevel</code> and control the actual level in the SLF4J backend without any significant overhead, also for production.</p></div>
<pre class="prettyprint"><code class="language-ruby">pekko {
  loggers = [&quot;org.apache.pekko.event.slf4j.Slf4jLogger&quot;]
  loglevel = &quot;DEBUG&quot;
  logging-filter = &quot;org.apache.pekko.event.slf4j.Slf4jLoggingFilter&quot;
}
</code></pre>
<p>One gotcha is that the timestamp is attributed in the event handler, not when actually doing the logging.</p>
<p>The SLF4J logger selected for each log event is chosen based on the <span class="group-scala"><code>Class[_]</code></span> <span class="group-java"><code>Class</code></span> of the log source specified when creating the <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span>, unless that was given directly as a string in which case that string is used (i.e. <span class="group-scala"><a href="https://www.javadoc.io/doc/org.slf4j/slf4j-api/latest/org.slf4j/org/slf4j/LoggerFactory.html#getLogger(java.lang.Class)" title="org.slf4j.LoggerFactory"><code>LoggerFactory.getLogger(c: Class[_ ])</code></a></span> <span class="group-java"><a href="https://www.javadoc.io/doc/org.slf4j/slf4j-api/latest/org.slf4j/org/slf4j/LoggerFactory.html#getLogger(java.lang.Class)" title="org.slf4j.LoggerFactory"><code>LoggerFactory.getLogger(Class c)</code></a></span> is used in the first case and <span class="group-scala"><a href="https://www.javadoc.io/doc/org.slf4j/slf4j-api/latest/org.slf4j/org/slf4j/LoggerFactory.html#getLogger(java.lang.String)" title="org.slf4j.LoggerFactory"><code>LoggerFactory.getLogger(s: String)</code></a></span> <span class="group-java"><a href="https://www.javadoc.io/doc/org.slf4j/slf4j-api/latest/org.slf4j/org/slf4j/LoggerFactory.html#getLogger(java.lang.String)" title="org.slf4j.LoggerFactory"><code>LoggerFactory.getLogger(String s)</code></a></span> in the second).</p><div class="callout note "><div class="callout-title">Note</div>
<p>Beware that the actor systemâs name is appended to a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" title="java.lang.String"><code>String</code></a> log source if the LoggingAdapter was created giving an <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/actor/ActorSystem.html" title="org.apache.pekko.actor.ActorSystem"><code>ActorSystem</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/actor/ActorSystem.html" title="org.apache.pekko.actor.ActorSystem"><code>ActorSystem</code></a></span> to the factory. If this is not intended, give a <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingBus.html" title="org.apache.pekko.event.LoggingBus"><code>LoggingBus</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingBus.html" title="org.apache.pekko.event.LoggingBus"><code>LoggingBus</code></a></span> instead as shown below:</p></div>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">val log = Logging(system.eventStream, &quot;my.nice.string&quot;)
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">final LoggingAdapter log = Logging.getLogger(system.eventStream(), &quot;my.string&quot;);
</code></pre></dd>
</dl>
<a id="slf4j-directly"></a>
<h3><a href="#using-the-slf4j-api-directly" name="using-the-slf4j-api-directly" class="anchor"><span class="anchor-link"></span></a>Using the SLF4J API directly</h3>
<p>If you use the SLF4J API directly in your application, remember that the logging operations will block while the underlying infrastructure writes the log statements.</p>
<p>This can be avoided by configuring the logging implementation to use a non-blocking appender. Logback provides <a href="https://logback.qos.ch/manual/appenders.html#AsyncAppender">AsyncAppender</a> that does this.</p>
<h3><a href="#logback-configuration" name="logback-configuration" class="anchor"><span class="anchor-link"></span></a>Logback configuration</h3>
<p>Logback has flexible configuration options and details can be found in the <a href="https://logback.qos.ch/manual/configuration.html">Logback manual</a> and other external resources.</p>
<p>One part that is important to highlight is the importance of configuring an <a href="https://logback.qos.ch/manual/appenders.html#AsyncAppender">AsyncAppender</a>, because it offloads rendering of logging events to a background thread, increasing performance. It doesn&rsquo;t block the threads of the <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/actor/ActorSystem.html" title="org.apache.pekko.actor.ActorSystem"><code>ActorSystem</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/actor/ActorSystem.html" title="org.apache.pekko.actor.ActorSystem"><code>ActorSystem</code></a></span> while the underlying infrastructure writes the log messages to disk or other configured destination. It also contains a feature which will drop <code>INFO</code> and <code>DEBUG</code> messages if the logging load is high.</p>
<p>A starting point for configuration of <code>logback.xml</code> for production:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/resources/logback-doc-prod.xml" target="_blank" title="Go to snippet source">source</a><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;

    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
        &lt;file&gt;myapp.log&lt;/file&gt;
        &lt;immediateFlush&gt;false&lt;/immediateFlush&gt;
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;
            &lt;fileNamePattern&gt;myapp_%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;
        &lt;/rollingPolicy&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;[%date{ISO8601}] [%level] [%logger] [%marker] [%thread] - %msg MDC: {%mdc}%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;appender name=&quot;ASYNC&quot; class=&quot;ch.qos.logback.classic.AsyncAppender&quot;&gt;
        &lt;queueSize&gt;8192&lt;/queueSize&gt;
        &lt;neverBlock&gt;true&lt;/neverBlock&gt;
        &lt;appender-ref ref=&quot;FILE&quot; /&gt;
    &lt;/appender&gt;

    &lt;root level=&quot;INFO&quot;&gt;
        &lt;appender-ref ref=&quot;ASYNC&quot;/&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
<p>For development you might want to log to standard out, but also have all <code>DEBUG</code> level logging to file, like in this example:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/actor-typed-tests/src/test/resources/logback-doc-dev.xml" target="_blank" title="Go to snippet source">source</a><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;

    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;
            &lt;level&gt;INFO&lt;/level&gt;
        &lt;/filter&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;[%date{ISO8601}] [%level] [%logger] [%marker] [%thread] - %msg MDC: {%mdc}%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
        &lt;file&gt;target/myapp-dev.log&lt;/file&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;[%date{ISO8601}] [%level] [%logger] [%marker] [%thread] - %msg MDC: {%mdc}%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;root level=&quot;DEBUG&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
        &lt;appender-ref ref=&quot;FILE&quot;/&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
<p>Place the <code>logback.xml</code> file in <code>src/main/resources/logback.xml</code>. For tests you can define different logging configuration in <code>src/test/resources/logback-test.xml</code>.</p>
<p>MDC properties can be included in the Logback output with for example <code>%X{pekkoSource}</code> specifier within the <a href="https://logback.qos.ch/manual/layouts.html#mdc">pattern layout configuration</a>:</p>
<pre><code>  &lt;encoder&gt;
    &lt;pattern&gt;%date{ISO8601} %-5level %logger{36} %X{pekkoSource} - %msg%n&lt;/pattern&gt;
  &lt;/encoder&gt;
</code></pre>
<p>All MDC properties as key-value entries can be included with <code>%mdc</code>:</p>
<pre><code>  &lt;encoder&gt;
    &lt;pattern&gt;%date{ISO8601} %-5level %logger{36} - %msg MDC: {%mdc}%n&lt;/pattern&gt;
  &lt;/encoder&gt;
</code></pre>
<h3><a href="#logging-thread-pekko-source-and-actor-system-in-mdc" name="logging-thread-pekko-source-and-actor-system-in-mdc" class="anchor"><span class="anchor-link"></span></a>Logging Thread, Pekko Source and Actor System in MDC</h3>
<p>Since the logging is done asynchronously the thread in which the logging was performed is captured in Mapped Diagnostic Context (MDC) with attribute name <code>sourceThread</code>.</p><div class="callout note "><div class="callout-title">Note</div>
<p>It will probably be a good idea to use the <code>sourceThread</code> MDC value also in non-Pekko parts of the application in order to have this property consistently available in the logs.</p></div>
<p>Another helpful facility is that Pekko captures the actorâs address when instantiating a logger within it, meaning that the full instance identification is available for associating log messages e.g. with members of a router. This information is available in the MDC with attribute name <code>pekkoSource</code>.</p>
<p>The address of the actor system, containing host and port if the system is using cluster, is available through <code>pekkoAddress</code>.</p>
<p>Finally, the actor system in which the logging was performed is available in the MDC with attribute name <code>sourceActorSystem</code>.</p>
<p>For more details on what this attribute containsâalso for non-actorsâplease see <a href="#how-to-log">How to Log</a>.</p>
<h3><a href="#more-accurate-timestamps-for-log-output-in-mdc" name="more-accurate-timestamps-for-log-output-in-mdc" class="anchor"><span class="anchor-link"></span></a>More accurate timestamps for log output in MDC</h3>
<p>Pekko&rsquo;s logging is asynchronous which means that the timestamp of a log entry is taken from when the underlying logger implementation is called, which can be surprising at first. If you want to more accurately output the timestamp, use the MDC attribute <code>pekkoTimestamp</code>.</p>
<h3><a href="#mdc-values-defined-by-the-application" name="mdc-values-defined-by-the-application" class="anchor"><span class="anchor-link"></span></a>MDC values defined by the application</h3>
<p>One useful feature available in Slf4j is <a href="https://logback.qos.ch/manual/mdc.html">MDC</a>, Pekko has a way to let the application specify custom values, for this you need to use a specialized <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span>, the <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/DiagnosticLoggingAdapter.html" title="org.apache.pekko.event.DiagnosticLoggingAdapter"><code>DiagnosticLoggingAdapter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/DiagnosticLoggingAdapter.html" title="org.apache.pekko.event.DiagnosticLoggingAdapter"><code>DiagnosticLoggingAdapter</code></a></span>. In order to get it you can use the factory, providing an <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/actor/Actor.html" title="pekko.actor.Actor"><code>Actor</code></a></span> <span class="group-java"><a href="https://pekko.apache.org/japi/pekko/current/org/apache/pekko/actor/AbstractActor.html" title="pekko.actor.AbstractActor"><code>AbstractActor</code></a></span> as logSource:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">// Within your Actor
val log: DiagnosticLoggingAdapter = Logging(this);
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">// Within your AbstractActor
final DiagnosticLoggingAdapter log = Logging.getLogger(this);
</code></pre></dd>
</dl>
<p>Once you have the logger, you need to add the custom values before you log something. This way, the values will be put in the SLF4J MDC right before appending the log and removed after.</p><div class="callout note "><div class="callout-title">Note</div>
<p>The cleanup (removal) should be done in the actor at the end, otherwise, next message will log with same MDC values, if it is not set to a new map. Use <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/DiagnosticLoggingAdapter.html#clearMDC():Unit" title="org.apache.pekko.event.DiagnosticLoggingAdapter"><code>log.clearMDC()</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/DiagnosticLoggingAdapter.html#clearMDC()" title="org.apache.pekko.event.DiagnosticLoggingAdapter"><code>log.clearMDC()</code></a></span>.</p></div>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/scala/docs/event/LoggingDocSpec.scala#L48-L54" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val mdc = Map(&quot;requestId&quot; -&gt; 1234, &quot;visitorId&quot; -&gt; 5678)
log.mdc(mdc)

// Log something
log.info(&quot;Starting new request&quot;)

log.clearMDC()</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L38-L40" target="_blank" title="Go to snippet source">source</a><code class="language-java">import org.apache.pekko.event.DiagnosticLoggingAdapter;
import java.util.HashMap;
import java.util.Map;</code></pre>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/java/jdocs/event/LoggingDocTest.java#L196-L218" target="_blank" title="Go to snippet source">source</a><code class="language-java">class MdcActor extends AbstractActor {

  final DiagnosticLoggingAdapter log = Logging.getLogger(this);

  @Override
  public Receive createReceive() {
    return receiveBuilder()
        .matchAny(
            msg -&gt; {
              Map&lt;String, Object&gt; mdc;
              mdc = new HashMap&lt;String, Object&gt;();
              mdc.put(&quot;requestId&quot;, 1234);
              mdc.put(&quot;visitorId&quot;, 5678);
              log.setMDC(mdc);

              log.info(&quot;Starting new request&quot;);

              log.clearMDC();
            })
        .build();
  }
}
</code></pre></dd>
</dl><div class="group-scala">
<p>For convenience, you can mix in the <code>log</code> member into actors, instead of defining it as above. This trait also lets you override <a href="https://pekko.apache.org/api/pekko/current/org/apache/pekko/actor/DiagnosticActorLogging.html#mdc(currentMessage:Any):org.apache.pekko.event.Logging.MDC" title="pekko.actor.DiagnosticActorLogging"><code>mdc(msg: Any)</code></a> for specifying MDC values depending on current message and lets you forget about the cleanup as well, since it already does it for you.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/apache/incubator-pekko/tree/main/docs/src/test/scala/docs/event/LoggingDocSpec.scala#L61-L84" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import Logging.MDC

final case class Req(work: String, visitorId: Int)

class MdcActorMixin extends Actor with pekko.actor.DiagnosticActorLogging {
  var reqId = 0

  override def mdc(currentMessage: Any): MDC = {
    reqId += 1
    val always = Map(&quot;requestId&quot; -&gt; reqId)
    val perMessage = currentMessage match {
      case r: Req =&gt; Map(&quot;visitorId&quot; -&gt; r.visitorId)
      case _      =&gt; Map()
    }
    always ++ perMessage
  }

  def receive: Receive = {
    case r: Req =&gt; {
      log.info(s&quot;Starting new request: ${r.work}&quot;)
    }
  }
}
</code></pre></div>
<p>Now, the values will be available in the MDC, so you can use them in the layout pattern:</p>
<pre><code>&lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
  &lt;encoder&gt;
    &lt;pattern&gt;
      %-5level %logger{36} [req: %X{requestId}, visitor: %X{visitorId}] - %msg%n
    &lt;/pattern&gt;
  &lt;/encoder&gt;
&lt;/appender&gt;
</code></pre>
<p>All MDC properties as key-value entries can be included with <code>%mdc</code>:</p>
<pre><code>  &lt;encoder&gt;
    &lt;pattern&gt;%date{ISO8601} %-5level %logger{36} - %msg MDC: {%mdc}%n&lt;/pattern&gt;
  &lt;/encoder&gt;
</code></pre>
<h3><a href="#using-markers" name="using-markers" class="anchor"><span class="anchor-link"></span></a>Using Markers</h3>
<p>Some logging libraries allow, in addition to MDC data, attaching so called &ldquo;markers&rdquo; to log statements. These are used to filter out rare and special events, for example you might want to mark logs that detect some malicious activity and mark them with a <code>SECURITY</code> tag, and in your appender configuration make these trigger emails and other notifications immediately.</p>
<p>Markers are available through the LoggingAdapters, when obtained via <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/Logging$.html#withMarker(logSource:org.apache.pekko.actor.Actor):org.apache.pekko.event.DiagnosticMarkerBusLoggingAdapter" title="org.apache.pekko.event.Logging"><code>Logging.withMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/Logging$.html#withMarker(org.apache.pekko.actor.Actor)" title="org.apache.pekko.event.Logging"><code>Logging.withMarker</code></a></span>. The first argument passed into all log calls then should be a <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LogMarker.html" title="org.apache.pekko.event.LogMarker"><code>LogMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LogMarker.html" title="org.apache.pekko.event.LogMarker"><code>LogMarker</code></a></span>.</p>
<p>The slf4j bridge provided by Pekko in <code>pekko-slf4j</code> will automatically pick up this marker value and make it available to SLF4J.</p>
<p>Pekko is logging some events with markers. Some of these events also include structured MDC properties. </p>
<ul>
  <li>The &ldquo;SECURITY&rdquo; marker is used for highlighting security related events or incidents.</li>
  <li>Pekko Actor is using the markers defined in <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/actor/ActorLogMarker$.html" title="org.apache.pekko.actor.ActorLogMarker"><code>ActorLogMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/actor/ActorLogMarker$.html" title="org.apache.pekko.actor.ActorLogMarker"><code>ActorLogMarker</code></a></span>.</li>
  <li>Pekko Cluster is using the markers defined in <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/cluster/ClusterLogMarker$.html" title="org.apache.pekko.cluster.ClusterLogMarker"><code>ClusterLogMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/cluster/ClusterLogMarker$.html" title="org.apache.pekko.cluster.ClusterLogMarker"><code>ClusterLogMarker</code></a></span>.</li>
  <li>Pekko Remoting is using the markers defined in <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/remote/RemoteLogMarker$.html" title="org.apache.pekko.remote.RemoteLogMarker"><code>RemoteLogMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/remote/RemoteLogMarker$.html" title="org.apache.pekko.remote.RemoteLogMarker"><code>RemoteLogMarker</code></a></span>.</li>
  <li>Pekko Cluster Sharding is using the markers defined in <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/cluster/sharding/ShardingLogMarker$.html" title="org.apache.pekko.cluster.sharding.ShardingLogMarker"><code>ShardingLogMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/cluster/sharding/ShardingLogMarker$.html" title="org.apache.pekko.cluster.sharding.ShardingLogMarker"><code>ShardingLogMarker</code></a></span>.</li>
</ul>
<p>Markers and MDC properties are automatically picked up by the <a href="https://github.com/logstash/logstash-logback-encoder">Logstash Logback encoder</a>.</p>
<p>The marker can be included in the Logback output with <code>%marker</code> and all MDC properties as key-value entries with <code>%mdc</code>.</p>
<pre><code>  &lt;encoder&gt;
    &lt;pattern&gt;[%date{ISO8601}] [%level] [%logger] [%marker] [%thread] - %msg MDC: {%mdc}%n&lt;/pattern&gt;
  &lt;/encoder&gt;
</code></pre>
<h4><a href="#using-slf4js-markers" name="using-slf4js-markers" class="anchor"><span class="anchor-link"></span></a>Using SLF4J&rsquo;s Markers</h4>
<p>It is also possible to use the <a href="https://www.javadoc.io/doc/org.slf4j/slf4j-api/latest/org.slf4j/org/slf4j/Marker.html" title="org.slf4j.Marker"><code>org.slf4j.Marker</code></a> with the <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/LoggingAdapter.html" title="org.apache.pekko.event.LoggingAdapter"><code>LoggingAdapter</code></a></span> when using slf4j.</p>
<p>Since the pekko-actor library avoids depending on any specific logging library, the support for this is included in <code>pekko-slf4j</code>, which provides the <span class="group-scala"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/slf4j/Slf4jLogMarker.html" title="org.apache.pekko.event.slf4j.Slf4jLogMarker"><code>Slf4jLogMarker</code></a></span><span class="group-java"><a href="https://pekko.apache.org/api/pekko/2.6.20+81-523134c3+20230202-1514-SNAPSHOT/org/apache/pekko/event/slf4j/Slf4jLogMarker.html" title="org.apache.pekko.event.slf4j.Slf4jLogMarker"><code>Slf4jLogMarker</code></a></span> type which can be passed in as first argument instead of the logging framework agnostic LogMarker type from <code>pekko-actor</code>. The most notable difference between the two is that slf4j&rsquo;s Markers can have child markers, so one can rely more information using them rather than just a single string.</p>
</div>
<div>
<a href="https://github.com/apache/incubator-pekko/tree/main/docs/src/main/paradox/logging.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
2.6.20+81-523134c3+20230202-1514*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="event-bus.html" title="Classic Event Bus" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Classic Event Bus
</span>
</div>
</a>
<a href="scheduler.html" title="Classic Scheduler" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Classic Scheduler
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Copyright Â© 2023 The Apache Software Foundation, Licensed under the Apache License, Version 2.0
</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="assets/javascripts/application.583bbe55.js"></script>
<script src="assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"."}})</script>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
<script src="assets/js/groups.js"></script>
</body>
</html>
